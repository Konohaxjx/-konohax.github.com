<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="konohax.GitHub.com : what why where">
    <script src="http://apps.bdimg.com/libs/jquery/1.7.2/jquery.min.js"></script>
    
   <title>xjx's personal website</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        #main{position: relative}
        .pin{padding: 10px 0 0 10px;float: left}
        .box{padding:10px;border: 1px solid #CCCCCC;border-radius: 5px}
        .box img{
            width: 200px;
            height: auto;
        }
</style>
  </head>

  <body>

    <!-- HEADER -->
    <div>待制作，先让我在本地做！！！</div>
    <!-- FOOTER  -->
    <body>
<div id="main">
    <div class="pin">
        <div class="box">
            <img src="http://b.hiphotos.baidu.com/image/pic/item/d009b3de9c82d15825ffd75c840a19d8bd3e42da.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://e.hiphotos.baidu.com/image/pic/item/4afbfbedab64034f04c380f4adc379310a551d31.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://g.hiphotos.baidu.com/image/pic/item/aa64034f78f0f736d1f00ef30855b319ebc41331.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://h.hiphotos.baidu.com/image/pic/item/8d5494eef01f3a2922e765c99b25bc315c607c8d.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://pic.6188.com/upload_6188s/flashAll/s800/20130426/1366938314VxqQP8.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://imgsrc.baidu.com/forum/pic/item/dc54564e9258d10977fa7df3d158ccbf6c814d52.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://img2.kfcdn.com/isy/upload/booklet/20140606/ufy7w5cy9zqhnn5z_watermark.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://a.hiphotos.bdimg.com/album/whcrop%3D657%2C370%3Bq%3D90/sign=2c1ab2dbf01f3a295a9d838cf6558107/d000baa1cd11728be75e9f27c8fcc3cec3fd2c47.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://img3.douban.com/view/photo/photo/public/p2273809124.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://i0.hdslb.com/video/64/645c43577ccf52ce801394496d99faa4.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://img3.douban.com/view/photo/photo/public/p2273876833.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://www.aityi.com/upload/201510/301551124014.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://i2.hdslb.com/video/1d/1db496c7fb42b08c82db633cdad9b1c5.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://cdn.aixifan.com/dotnet/artemis/u/cms/www/201511/07151342nn4iuer5.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://ww2.sinaimg.cn/large/afdc790bgw1ewweqne4btj21400miq70.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://img3.douban.com/view/photo/photo/public/p2298620335.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://ww2.sinaimg.cn/large/72dd9116jw1exc4pfx5e0j20zk0k0tcy.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://i4.cqnews.net/ent/attachement/jpg/site82/2015-11-19/1856844778060561219.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://i1.hdslb.com/video/30/30c0439b05050393ab9585e40ce96940.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://imgsrc.baidu.com/forum/w=580/sign=21df6dc5dbc451daf6f60ce386fc52a5/502f2b12b31bb051c21346b3307adab44bede0cb.jpg"/>
        </div>
    </div>
    <div class="pin">
        <div class="box">
            <img src="http://img3.douban.com/view/photo/photo/public/p2277263874.jpg"/>
        </div>
    </div>
</div>
  <script type="text/javascript">
    $(window).on('load',function(){
    waterfall();
    var dataInt={'data':[{'src':'http://npic7.edushi.com/cn/zixun/zh-chs/2015-08/11/ee9e5534ab0047c1962a3d5ed811c5fb.jpg'},
    {'src':'http://i3.hoopchina.com.cn/user/289/2737289/13059794690.jpg'},
    {'src':'http://b.zol-img.com.cn/desk/bizhi/image/1/960x600/134856641957.jpg'},
    {'src':'http://img2.imgtn.bdimg.com/it/u=2952100908,4178186784&fm=21&gp=0.jpg'}]};
    $(window).on('scroll',function(){
        if (check()){
            $.each( dataInt.data, function( index, value ){
                var $oPin = $('<div>').addClass('pin').appendTo( $( "#main" ) );
                var $oBox = $('<div>').addClass('box').appendTo( $oPin );
                $('<img>').attr('src','./img/' + $( value).attr( 'src') ).appendTo($oBox);
            });
            waterfall();
        };
    })
});


function waterfall(){
    var $pin=$("#main>div");
    var pinW=$pin.eq(0).outerWidth();
   // var wid=$(window).width();
    var n=Math.floor($(window).width()/pinW);
    //设置main的宽度
    $("#main").width(pinW*n).css("margin","0 auto");
    var arra=[];
    $pin.each(function(index,value){
        var h=$pin.eq(index).outerHeight();
        if(index<n){
            arra[index]=h;
        }else {
            var minH=Math.min.apply(null,arra);
            var minN= $.inArray(minH,arra);
            $(value).css({
                'position':'absolute',
                'top':minH+"px",
                'left':pinW*minN+"px"
            })
            arra[minN]+=$pin.eq(index).outerHeight();
        }
    })
}
function check(){
    var $last=$("#main>div").last();
    var a=$last.offset().top+Math.floor($last.outerHeight()/2);
    var b=$(window).scrollTop();
    var c=$(window).height();
    var d=b+c;
    return (a<d)?true:false;
}
    </script>  

  </body>
</html>
